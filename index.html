<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Archivio Sandro Master</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

  <style>
    :root {
      --copy-btn: #6c5ce7; --report: #00b894; --web: #0984e3; --gray-btn: #2d2d2d; --danger: #cc0000; --undo: #fdcb6e;
    }

    body {
      font-family: -apple-system, system-ui, sans-serif;
      margin: 0; padding: 20px; background: #0f0f0f; color: #fff;
      -webkit-tap-highlight-color: transparent;
    }

    /* TOOLBAR & RICERCA */
    .toolbar { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 15px; }
    .btn-tool { padding: 12px 14px; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; color: white; font-size: 11px; }
    
    .search-container { display: flex; gap: 8px; margin-bottom: 25px; }
    .search-box { flex-grow: 1; padding: 14px; border-radius: 12px; border: 1px solid #333; background: #1c1c1c; color: white; outline: none; }
    .btn-vai { background: var(--web); border: none; border-radius: 12px; padding: 0 25px; color: white; font-weight: bold; }

    /* CARDS */
    .cards { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 25px; }
    .card { background: #1c1c1c; border-radius: 16px; padding: 25px; text-align: center; border: 1px solid #333; }

    /* PANNELLO NOTE CON UNDO */
    .panel { background: #1c1c1c; border-radius: 16px; padding: 20px; border: 1px solid #333; margin-bottom: 15px; position: relative; }
    .panel-title { color: #666; font-size: 0.75rem; text-transform: uppercase; margin-bottom: 10px; }
    .quick-note-area { width: 100%; height: 80px; background: transparent; border: none; color: #fff; font-size: 1rem; resize: none; outline: none; }

    .btn-trash { background: var(--danger); border: none; border-radius: 50%; width: 35px; height: 35px; color: white; cursor: pointer; }
    .btn-undo { 
        background: var(--undo); color: #000; border: none; border-radius: 8px; 
        padding: 5px 10px; font-size: 0.7rem; font-weight: bold; 
        display: none; margin-left: 10px; animation: fadeIn 0.3s;
    }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* POPUP */
    #popup { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: none; flex-direction: column; z-index: 999; }
    #popupContent { height: 100%; display: flex; flex-direction: column; padding: 20px; }
    #popupBody { background: #0d0d0d; border-radius: 10px; padding: 15px; overflow: auto; font-family: monospace; flex-grow: 1; white-space: pre; }
  </style>
</head>
<body>

  <h1>Archivio Codici Sandro</h1>

  <div class="toolbar">
      <button class="btn-tool" style="background:var(--copy-btn)" onclick="copyAll()">üìã COPIA TUTTO</button>
      <button class="btn-tool" style="background:var(--report)" onclick="alert('üìä Report OK')">üìä REPORT</button>
      <button class="btn-tool" style="background:var(--web)" onclick="openPopup('webapp')">üåê WEB APP</button>
      <button class="btn-tool" style="background:var(--gray-btn)" onclick="alert('‚úèÔ∏è Edit Mode')">‚úèÔ∏è EDIT</button>
  </div>

  <div class="search-container">
    <input type="text" id="searchInput" class="search-box" placeholder="Cerca codice...">
    <button class="btn-vai" onclick="cerca()">VAI</button>
  </div>

  <div class="cards">
    <div class="card" onclick="openPopup('html')">üìÑ<br>HTML</div>
    <div class="card" onclick="openPopup('css')">üé®<br>CSS</div>
    <div class="card" onclick="openPopup('js')">‚ö°<br>JS</div>
    <div class="card" onclick="openPopup('python')">üêç<br>PY</div>
  </div>

  <div class="panel">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
        <div class="panel-title">Note Rapide</div>
        <div>
            <button id="undoBtn" class="btn-undo" onclick="ripristinaNota()">‚Ü©Ô∏è RIPRISTINA</button>
            <button class="btn-trash" onclick="eliminaNota()">üóëÔ∏è</button>
        </div>
    </div>
    <textarea id="noteArea" class="quick-note-area" placeholder="Scrivi qui..."></textarea>
  </div>

  <div id="popup">
    <div id="popupContent">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
        <h2 id="popupTitle" style="margin:0; color:var(--web)"></h2>
        <button class="btn-tool" style="background:var(--danger)" onclick="closePopup()">CHIUDI</button>
      </div>
      <pre><code id="popupBody"></code></pre>
    </div>
  </div>

  <script>
    const database = {
      html: "", css: "/* Master CSS */", 
      js: "// Master JS", python: "# Master PY", webapp: ""
    };

    let notaTemporanea = "";
    let undoTimeout;

    function vibrate() { if (navigator.vibrate) navigator.vibrate(25); }

    // LOGICA ELIMINA E RIPRISTINA
    function eliminaNota() {
      vibrate();
      const area = document.getElementById("noteArea");
      if (area.value.trim() === "") return;

      notaTemporanea = area.value; // Salva la nota prima di cancellare
      area.value = "";
      
      const btnUndo = document.getElementById("undoBtn");
      btnUndo.style.display = "inline-block";

      // Il tasto ripristina sparisce dopo 5 secondi
      clearTimeout(undoTimeout);
      undoTimeout = setTimeout(() => {
        btnUndo.style.display = "none";
        notaTemporanea = "";
      }, 5000);
    }

    function ripristinaNota() {
      vibrate();
      document.getElementById("noteArea").value = notaTemporanea;
      document.getElementById("undoBtn").style.display = "none";
      notaTemporanea = "";
    }

    function cerca() {
      vibrate();
      const q = document.getElementById("searchInput").value.toLowerCase();
      if (database[q]) openPopup(q); else alert("Non trovato");
    }

    function openPopup(type) {
      vibrate();
      document.getElementById("popup").style.display = "flex";
      document.getElementById("popupTitle").textContent = type.toUpperCase();
      document.getElementById("popupBody").textContent = database[type];
      hljs.highlightAll();
    }

    function closePopup() { vibrate(); document.getElementById("popup").style.display = "none"; }
    
    function copyAll() { vibrate(); navigator.clipboard.writeText(JSON.stringify(database)); alert("Copiato!"); }
  </script>
</body>
</html>
